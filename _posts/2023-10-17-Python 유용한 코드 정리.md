---
layout: post
title: "Python 유용한 코드 정리"
summary: "Python 유용한 코드 정리"
author: taehun
date: '2023-10-17 19:00:00 +0900'
category: Python
toc: true
toc_sticky: true
toc_label: "My Table of Contents"
toc_icon: "cog"
thumbnail: null
keywords: Python
permalink: /21
mathjax: true
use_math: true
---

Last update: 2023.10.31<br>

> Python 유용한 코드 정리<br>

#### Index
---

- [1. Operator](#1-operator)
- [2. Einstein summation](#2-einstein-summation)<br><br>

#### **1. Operator**
  
<br>

1) Unpacking Dictionary Items: The ** operator can be used to unpack the contents of one dictionary into another, or to pass dictionary contents as keyword arguments to a function.
<br>

```python
def example_func(**kwargs):
    for key, value in kwargs.items():
        print(f"{key}: {value}")

example_func(a=1, b=2, c=3)
# Outputs:
# a: 1
# b: 2
# c: 3
```

```python
def greet(first_name="", last_name=""):
    print(f"Hello, {first_name} {last_name}!")

person_info = {"first_name": "John", "last_name": "Doe"}
greet(**person_info)  # Outputs: Hello, John Doe!
```

In this example, the **person_info in the function call unpacks the dictionary's key-value pairs as keyword arguments to the greet function.

2) Additionally, when defining functions, **kwargs is used to capture additional keyword arguments passed to the function:

```python
def example_func(**kwargs):
    for key, value in kwargs.items():
        print(f"{key}: {value}")

example_func(a=1, b=2, c=3)
# Outputs:
# a: 1
# b: 2
# c: 3
```
Here, **kwargs captures all the additional keyword arguments passed to the function in a dictionary named kwargs.

#### **2. Einstein summation**

1) Transpose

```python
A = torch.randint(1, 10, (2,2))
B = torch.einsum('ij->ji', A)
```

2) Sum of total element

```python
A = torch.randint(1, 10, (2,2))
sum = torch.einsum('ij->', A)
```

3) Column/row sum
   
```python
A = torch.randint(1, 10, (2,2))
# Column sum
col_sum = torch.einsum('ij->j', A)
row_sum = torch.einsum('ij->i', A)
```

4) Matrix multiplication
   
```python
A = torch.randint(1, 10, (2,3))
B = torch.randint(1, 10, (3,2))
b = torch.randint((1, 10, (3))

Ab = torch.einsum('ij,j->i', A,b)
AB = torch.einsum('ij,jk->ik', A,B)
```

5) Dot/outer/Hadamard product

```python
a = torch.randint(1, 10, (2))
b = torch.randint(1, 10, (2))
A = torch.randint(1, 10, (2,3))
B = torch.randint(1, 10, (3,2))

a_dot_b = torch.einsum('i,i->', a,b)
a_outer_b = torch.einsum('i,j->ij', a,b) # dyadic product
A_had_B = torch.einsum('ij,ij->ij', A,B)
```

6) Batch matrix multiplication

```python
A = torch.randint(1, 10, (100, 2,3))
B = torch.randint(1, 10, (100, 3,2))

A_bmm_B = torch.einsum('ijk,ikl->ijl', A,B)
```

7) Bilinear transformation

```python
A = torch.randint(1, 10, (2,3))
B = torch.randint(1, 10, (3,4,5))
C = torch.randint(1, 10, (5,2))

ABC = torch.einsum('ij,jkl,lm->ikm', A,B,C)
```
